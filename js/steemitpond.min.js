! function(a) {
    if ("function" == typeof define && define.amd) define(a);
    else if ("object" == typeof exports) module.exports = a();
    else {
        var b = window.Cookies,
            c = window.Cookies = a();
        c.noConflict = function() {
            return window.Cookies = b, c
        }
    }
}(function() {
    function a() {
        for (var a = 0, b = {}; a < arguments.length; a++) {
            var c = arguments[a];
            for (var d in c) b[d] = c[d]
        }
        return b
    }

    function b(c) {
        function d(b, e, f) {
            var g;
            if ("undefined" != typeof document) {
                if (arguments.length > 1) {
                    if (f = a({
                            path: "/"
                        }, d.defaults, f), "number" == typeof f.expires) {
                        var h = new Date;
                        h.setMilliseconds(h.getMilliseconds() + 864e5 * f.expires), f.expires = h
                    }
                    try {
                        g = JSON.stringify(e), /^[\{\[]/.test(g) && (e = g)
                    } catch (a) {}
                    return e = c.write ? c.write(e, b) : encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent), b = encodeURIComponent(String(b)), b = b.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent), b = b.replace(/[\(\)]/g, escape), document.cookie = [b, "=", e, f.expires ? "; expires=" + f.expires.toUTCString() : "", f.path ? "; path=" + f.path : "", f.domain ? "; domain=" + f.domain : "", f.secure ? "; secure" : ""].join("")
                }
                b || (g = {});
                for (var i = document.cookie ? document.cookie.split("; ") : [], j = /(%[0-9A-Z]{2})+/g, k = 0; k < i.length; k++) {
                    var l = i[k].split("="),
                        m = l.slice(1).join("=");
                    '"' === m.charAt(0) && (m = m.slice(1, -1));
                    try {
                        var n = l[0].replace(j, decodeURIComponent);
                        if (m = c.read ? c.read(m, n) : c(m, n) || m.replace(j, decodeURIComponent), this.json) try {
                            m = JSON.parse(m)
                        } catch (a) {}
                        if (b === n) {
                            g = m;
                            break
                        }
                        b || (g[n] = m)
                    } catch (a) {}
                }
                return g
            }
        }
        return d.set = d, d.get = function(a) {
            return d.call(d, a)
        }, d.getJSON = function() {
            return d.apply({
                json: !0
            }, [].slice.call(arguments))
        }, d.defaults = {}, d.remove = function(b, c) {
            d(b, "", a(c, {
                expires: -1
            }))
        }, d.withConverter = b, d
    }
    return b(function() {})
});
var WebSocketWrapper;
WebSocketWrapper = function() {
    function a(a) {
        this.server = a, this.connection = {}, this.callbacks = []
    }
    var b = a.prototype;
    return b.connect = function() {
        var a = this;
        return new Promise(function(b, c) {
            "WebSocket" in window ? (a.connection = new WebSocket(a.server), a.connection.onopen = function() {
                b(a.connection)
            }, a.connection.onerror = function(a) {
                c(Error("Error connecting to server, please reload the page!" + a))
            }, a.connection.onmessage = function(b) {
                var c = JSON.parse(b.data);
                a.callbacks[c.id](c.result)
            }) : c(Error("Your browser is too old, please get a recent one!"))
        })
    }, b.send = function(a, b) {
        this.callbacks[a.id] = b;
        var c = JSON.stringify(a);
        this.connection.send(c)
    }, a
}();
var SteemWrapper;
SteemWrapper = function() {
    function a(a) {
        this.ws = a, this.id = 0
    }
    var b = a.prototype;
    return b.send = function(a, b, c) {
        ++this.id;
        var d = {
            id: this.id,
            method: a,
            params: b
        };
        this.ws.send(d, c)
    }, a
}();
var SteemitPond = function() {
    var k, a = "wss://node.steem.ws",
        b = new WebSocketWrapper(a),
        c = new SteemWrapper(b),
        d = $("#steemit-pond"),
        e = 0,
        f = "http://steemit.com/",
        g = 350,
        h = "STEEMIT_POND_USER_FILTERS_COOKIE",
        i = ["@justfishing", "@satoshiroller", "@sweepstake", "@sorteo"],
        j = !1,
        l = [],
        m = function() {
            m.menu(), m.sound(), v()
        };
    m.menu = function() {
        $("#sound").click(function() {
            n()
        }), $("#user-filters").click(function() {
            o()
        }), $("#app-info").click(function() {
            p()
        }), $(".close-menu-btn").click(function() {
            q()
        }), m.userFiltersInput(), m.existingFilters()
    }, m.sound = function() {
        k = document.createElement("audio"), k.setAttribute("src", "sound/bubbles-underwater.mp3"), k.loop = !0
    }, m.userFiltersInput = function() {
        $(".add-user-filter-input").keypress(function(a) {
            13 == a.which && r($(".add-user-filter-input").val())
        }), $(".add-user-filter-submit").click(function() {
            r($(".add-user-filter-input").val())
        })
    }, m.existingFilters = function() {
        var a = Cookies.get(h);
        if (document.cookie.indexOf(h) < 0)
            for (var b = 0; b < i.length; b++) u(i[b]), l.push(i[b]);
        else l = a.split(", "), l = l.slice(0, -1);
        for (var b = 0; b < l.length; b++) null !== l[b] && s(l[b])
    };
    var n = function() {
            j ? (j = !1, k.pause(), $("#sound").html('<span class="glyphicon glyphicon-volume-off"></span>')) : (j = !0, k.play(), $("#sound").html('<span class="glyphicon glyphicon-volume-up"></span>'))
        },
        o = function() {
            $(".info-menu").hide(), $(".user-filters-menu").hide(), $("#side-menu").addClass("sidenav-box-shadow").width(g), $(".user-filters-menu").fadeIn(500)
        },
        p = function() {
            $(".user-filters-menu").hide(), $(".info-menu").show(), $("#side-menu").addClass("sidenav-box-shadow").width(g)
        },
        q = function() {
            $("#side-menu").remove("sidenav-box-shadow").width(0)
        },
        r = function(a) {
            a = a.replace(/ /g, ""), a = a.replace(/,/g, ""), "" !== a && ("@" === a.charAt(0) && (a = a.substr(1)), a = a.toLowerCase(), a = "@" + a, u(a), l.push(a), s(a))
        },
        s = function(a) {
            var b = $(".user-filters-menu").children("ul"),
                c = $("<li></li>"),
                d = a,
                e = $('<span class="glyphicon glyphicon-remove"></span>');
            e.click(function() {
                t($(this).parent("li"))
            }), c.append(d), c.append(e), b.append(c), $(".add-user-filter-input").val("")
        },
        t = function(a) {
            var b = a.text(),
                c = l.indexOf(b);
            c != -1 && l.splice(c, 1);
            var d = Cookies.get(h),
                e = b + ", ";
            d = d.replace(e, ""), Cookies.set(h, d, {
                expires: 365
            }), a.hide().remove()
        },
        u = function(a) {
            var b = Cookies.get(h);
            b = b ? b + a + ", " : a + ", ", Cookies.set(h, b, {
                expires: 365
            })
        },
        v = function() {
            b.connect().then(function(a) {
                c.send("get_dynamic_global_properties", [], function(a) {
                    e != a.last_irreversible_block_num && (e = a.last_irreversible_block_num, w(e)), setTimeout(v(), 1e3)
                })
            })
        },
        w = function(a) {
            c.send("get_block", [a], function(a) {
                a.transactions.forEach(function(a) {
                    x(a.operations[0])
                })
            })
        },
        x = function(a) {
            var b = a[0],
                c = a[1];
            switch (b) {
                case "comment":
                    y(c);
                    break;
                case "vote":
                    C(c);
                    break;
                case "account_create":
                    H(c);
                    break;
                case "account_update":
                    I(c);
                    break;
                case "pow":
                    L(c);
                    break;
                case "transfer":
                    J(c);
                    break;
                case "limit_order_create":
                    K(c)
            }
        },
        y = function(a) {
            "" !== a.title ? z(a) : A(a)
        },
        z = function(a) {
            var b = f + a.parent_permlink + "/@" + a.author + "/" + a.permlink,
                c = f + "@" + a.author,
                d = $('<div class="new-post-title"></div>'),
                e = $('<a target="_blank" href="' + b + '">' + a.title + "</a>");
            d.append(e);
            var g = $('<div class="new-post-author"></div>'),
                h = $('<a class="auth-url" target="_blank" href="' + c + '">' + a.author + "</a>");
            g.append(h);
            var i = $('<div class="new-post-data"></div>');
            i.append(d), i.append(g);
            var m, j = $('<a target="_blank" href="' + b + '"></a>'),
                k = $('<div class="new-post"></div>');
            m = l.indexOf("@" + a.author) > -1 ? $('<img class="new-post-image" src="img/scuba-1.png" />') : $('<img class="new-post-image" src="img/whale.png" />'), j.append(m), k.append(i), k.append(j), M(k, 350, 18e3, 32e3)
        },
        A = function(a) {
            var i, b = "steempond/@" + a.parent_author,
                c = "/" + a.parent_permlink,
                d = "#@" + a.author + "/",
                e = f + b + c + d + a.permlink,
                g = $('<div class="existing-post-author">' + a.author + "</div>"),
                h = $('<a target="_blank" href="' + e + '"></a>');
            l.indexOf("@" + a.author) > -1 ? (i = $('<img class="existing-post-image" src="img/scuba-2.png" />'), $(h).addClass("existing-post-link-filter-applied")) : i = $('<img class="existing-post-image" src="' + B() + '" />'), h.append(i), h.append(g);
            var j = $('<div class="existing-post"></div>');
            j.append(h), M(j, 400, 22e3, 38e3)
        },
        B = function() {
            var a = Math.floor(5 * Math.random()) + 1;
            return "img/minnow-" + a + ".png"
        },
        C = function(a) {
            a.weight < 0 ? E(a) : D(a)
        },
        D = function(a) {
            var e, b = f + "steempond/@" + a.author + "/" + a.permlink,
                c = $('<div class="upvote-voter">' + a.voter + "</div>"),
                d = $('<a target="_blank" href="' + b + '"></a>');
            if ("mynameisbrian" === a.author) e = $('<img class="upvote-image" src="img/easter-egg-1.png" />'), $(d).addClass("upvote-link-easter-egg");
            else if (l.indexOf("@" + a.voter) > -1) e = $('<img class="upvote-image" src="img/scuba-3.png" />'), $(d).addClass("upvote-link-filter-applied");
            else {
                e = $('<img class="upvote-image" src="img/bubble.png" />');
                var g = Math.floor(11 * Math.random()) + 20;
                e.css("width", g)
            }
            d.append(e), d.append(c);
            var h = $('<div class="upvote"></div>');
            h.append(d), N(h, 125, 15e3, 28e3)
        },
        E = function(a) {
            var e, b = f + "steempond/@" + a.author + "/" + a.permlink,
                c = $('<div class="downvote-voter">' + a.voter + "</div>"),
                d = $('<a target="_blank" href="' + b + '"></a>');
            l.indexOf("@" + a.voter) > -1 ? (e = $('<img class="downvote-image" src="img/barrel.png" />'), $(d).addClass("downvote-link-filter-applied"), $(d).css({
                WebkitTransform: "rotate(" + F() + "deg)"
            }), $(d).css({
                "-moz-transform": "rotate(" + F() + "deg)"
            })) : e = $('<img class="downvote-image" src="' + G() + '" />'), d.append(c), d.append(e);
            var g = $('<div class="downvote"></div>');
            g.append(d), O(g, 125, 12e3, 25e3)
        },
        F = function() {
            var a = Math.floor(20 * Math.random()) + 1,
                b = Math.random() < .5 ? -1 : 1;
            return a * b
        },
        G = function() {
            var a = Math.floor(2 * Math.random()) + 1;
            return "img/garbage-" + a + ".png"
        },
        H = function(a) {
            var b = f + "@" + a.new_account_name,
                c = $('<div class="new-account-name">' + a.new_account_name + "</div>"),
                d = $('<img class="new-account-image" src="img/dolphin-1.png" />'),
                e = $('<a target="_blank" href="' + b + '"></a>');
            e.append(c), e.append(d);
            var g = $('<div class="new-account"></div>');
            g.append(e), M(g, 400, 2e4, 32e3)
        },
        I = function(a) {
            var e, b = f + "@" + a.account,
                c = $('<div class="update-account-name">' + a.account + "</div>"),
                d = $('<a target="_blank" href="' + b + '"></a>');
            l.indexOf("@" + a.account) > -1 ? (e = e = $('<img class="update-account-image" src="img/scuba-4.png" />'), $(d).addClass("account-update-link-filter-applied")) : e = $('<img class="update-account-image" src="img/baluga.png" />'), d.append(c), d.append(e);
            var g = $('<div class="update-account"></div>');
            g.append(d), M(g, 400, 25e3, 35e3)
        },
        J = function(a) {
            var b = f + "@" + a.from,
                c = f + "@" + a.to,
                d = $('<div class="transfer-from"></div>'),
                e = $("<div>" + a.amount + ' from <a target="_blank" href="' + b + '">' + a.from + "</a>"),
                g = $('<a target="_blank" href="' + b + '"><img src="img/barracuda.png" /></a>');
            d.append(e), d.append(g);
            var h = $('<div class="transfer-to"></div>'),
                i = $('<div>to <a target="_blank" href="' + c + '">' + a.to + "</a>"),
                j = $('<a target="_blank" href="' + c + '"><img src="img/barracuda.png" /></a>');
            h.append(i), h.append(j);
            var k = $('<div class="transfer"></div>');
            k.append(d), k.append(h), M(k, 400, 3e4, 4e4)
        },
        K = function(a) {
            var b = f + "@" + a.owner,
                c = $('<a class="limit-create-owner" target="_blank" href="' + b + '">' + a.owner + "</a>"),
                d = $('<img class="limit-create-image" src="img/turtle.png" />'),
                e = $("<div>" + a.amount_to_sell + "</div>"),
                g = $('<a target="_blank" href="' + b + '"></a>'),
                h = $('<div class="limit-create"></div>');
            g.append(e), g.append(d), g.append(c), h.append(g), M(h, 400, 35e3, 45e3)
        },
        L = function(a) {
            var b = f + "@" + a.worker_account,
                c = $('<div class="pow-account-name">' + a.worker_account + "</div>"),
                d = $('<a target="_blank" href="' + b + '"></a>'),
                e = $('<img class="pow-image" src="img/shark-1.png" />');
            d.append(e), d.append(c);
            var g = $('<div class="pow"></div>');
            g.append(d), M(g, 400, 28e3, 4e4)
        },
        M = function(a, b, c, e) {
            var f = $("header").height() + b,
                g = $(window).height() - b - a.height(),
                h = Math.floor(Math.random() * (g - f + 1)) + f;
            d.append(a), a.css({
                position: "absolute",
                top: h,
                left: 0 - a.width()
            });
            var i = Math.floor(Math.random() * (e - c + 1)) + c,
                j = a.offset().top - b,
                k = a.offset().top + b,
                l = Math.floor(Math.random() * (k - j + 1)) + j;
            a.animate({
                left: "105%",
                top: l
            }, i, function() {
                a.remove()
            })
        },
        N = function(a, b, c, e) {
            var f = b,
                g = $(window).width() - b - a.width(),
                h = Math.floor(Math.random() * (g - f + 1)) + f;
            d.append(a), a.css({
                position: "absolute",
                top: $(window).height() + a.height(),
                left: h
            });
            var i = Math.floor(Math.random() * (e - c + 1)) + c,
                j = a.offset().left - b,
                k = a.offset().left + b,
                l = Math.floor(Math.random() * (k - j + 1)) + j;
            a.animate({
                left: l,
                top: 0 - a.height()
            }, i, "linear", function() {
                a.remove()
            })
        },
        O = function(a, b, c, e) {
            var i = b,
                j = $(window).width() - b - a.width(),
                k = Math.floor(Math.random() * (j - i + 1)) + i;
            d.append(a), a.css({
                position: "absolute",
                top: 0 - a.height() - 50,
                left: k
            });
            var l = Math.floor(Math.random() * (e - c + 1)) + c,
                m = a.offset().left - b,
                n = a.offset().left + b,
                o = Math.floor(Math.random() * (n - m + 1)) + m;
            a.animate({
                left: o,
                top: $(window).height() + a.height()
            }, l, function() {
                a.remove()
            })
        };

    return {
        init: m
    }
}();
$(document).ready(function() {
    window.WebSocket ? SteemitPond.init() : alert("Websocket is not supported by your browser.")

    SteemitPond.init();
});
